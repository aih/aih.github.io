---
layout: post
title: 'California Laws: Converting Plain Text to HTML'
date: '2011-05-16T22:06:00.000-07:00'
author: Ari Hershowitz
tags:
- XHTML
- HTML
- Open Government
- California Legislation
modified_time: '2011-05-23T11:52:59.101-07:00'
thumbnail: https://lh6.ggpht.com/_KSKlgXwN6_4/TdICYZWuO7I/AAAAAAAADrU/jnCBg2QFppw/s72-c/1-thumb.png
blogger_id: tag:blogger.com,1999:blog-7029518648320057552.post-869813652885944911
blogger_orig_url: https://blog.linkedlegislation.com/2011/05/california-laws-converting-plain-text.html
---

<div style="clear: both;">How to convert legislation from plain text to structured html? For those more interested in results than process, you're in luck. This post focuses primarily on the results of the transformation. <br /><br /></div><div style="clear: both;">I am working here with California's statutes, published in plain text on the <a href="https://leginfo.ca.gov/">legislature's website</a>. There are many layers of meaning that could be added to the raw text, and as a start, I'm focusing on elements that make reading and navigating the statute easier. In particular: </div><div style="clear: both;"></div><ul style="clear: both;"><li>identifying where sections, subdivisions and other elements start and end and <br /></li><li>adding hyperlinks from a reference to the section referenced (adding a hyperlink from references like this: "as defined in <i>Section 203</i> of the <i>Government Code</i>").</li></ul><div style="clear: both;">For example, <a href="https://tabulaw.com/CALaw/15210-15215" target="_blank" title="Vehicle Code s. 15210 raw text">here</a> are sections of the CA Vehicle Code that set out definitions for the sections that follow. <a href="https://tabulaw.com/CALaw/15210-15215.html" target="_blank" title="s.15210 in HTML">Here</a> are the same sections in html, after the transformations described below.</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: right; margin-left: 1em; text-align: right;"><tbody><tr><td style="text-align: center;"><a class="image-link" href="https://lh6.ggpht.com/_KSKlgXwN6_4/TdICE9AUpeI/AAAAAAAADrI/R7oMRkLaPtc/s800/1.png" style="margin-left: auto; margin-right: auto;"><img align="left" class="linked-to-original" height="176" src="https://lh6.ggpht.com/_KSKlgXwN6_4/TdICYZWuO7I/AAAAAAAADrU/jnCBg2QFppw/s320/1-thumb.png" style="display: inline; float: left; margin-bottom: 10px; margin-left: 0px; margin-right: 10px; margin-top: 0px;" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Before (no links)</td></tr></tbody></table><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><a class="image-link" href="https://lh6.ggpht.com/_KSKlgXwN6_4/TdICFhDhqFI/AAAAAAAADrQ/mAOGe2cGSjc/s800/15210html1.png" style="margin-left: auto; margin-right: auto;"><img align="left" class="linked-to-original" height="97" src="https://lh6.ggpht.com/_KSKlgXwN6_4/TdICY18Q0tI/AAAAAAAADrc/c7tJozd36Ds/s640/15210html1-thumb.png" style="display: inline; float: left; margin-bottom: 10px; margin-left: 0px; margin-right: 10px; margin-top: 0px;" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">After (now with links)</td></tr></tbody></table><br /><div style="clear: both;"><br />Nothing earth-shattering, but for even this level of metadata, it took a number of steps to add the structural information back in to the statutes (see an outline of the process below the fold). After a bit more polishing, I will upload my scripts to <a href="https://github.com/aih" target="_blank" title="My Github account">Github</a>, in the hopes that my hacks can be improved upon.</div><div style="clear: both;"><br />For those who want to skip straight to the conclusion, here it is: automated transformations can add back in much of the metadata that is needed to navigate statutes. But the automated methods will not catch all of the relevant information--even all of the relevant references to other primary legal sources. To add the rest of this information into a public domain electronic format will require (a) that <b>governments</b> publish the data in a structured format to begin with, (b) a Wikipedia-like platform for expert <b>crowdsourcing</b> of legal sources, (c) a <b>fundamental change</b> in the current pay model for publishing of legal information or (d) <b>all of the above</b>.<br /><br /></div><div style="clear: both;">Now to see, in more detail, what was gained from this first layer of transformations of the text.<br /><strong id="fivestep">What works:</strong></div><ul style="clear: both;"><li>Sections (e.g. 15210.) , subdivisions (e.g. 15210(b)) and sub-subdivisions (e.g. 15210(b)(1)) identified.<br /></li><li>References to each of the 29 California Codes are linked.</li><li>Most references to other Sections are hyperlinked.</li></ul><div style="clear: both;"><strong>What doesn't (yet) work:</strong></div><ul style="clear: both;"><li>I haven't yet posted the linked documents online.<br /></li><li>Further subdivisions (e.g. 15210(b)(2)(A)) have not yet been identified in the text.<br /></li><li>The parser does not yet recognize some forms of reference to other Sections. E.g. where the reference is set out as a list of three or more: "<i>in the manner described under Section 2800.1, 2800.2 or 2800.3...</i>"<br /></li><li>References to separate legislative Acts are not linked (e.g. "<i>the Commercial Motor Vehicle Safety Act</i>")</li><li>References outside the CA Codes are not yet linked, e.g. references to U.S. Federal statute or regulations.</li></ul><div style="clear: both;">To address the points above will require a few more layers of filtering.</div><a name='more'></a><br /><div style="clear: both;" id="Outline">This is an outline of the process I used: <br /><ol><li>Convert from text to html (Perl text2html module)</li><li>Identify section, subsection and subdivision headings. (Linux Super Sed utility)</li><li>Identify references to external Codes (Linux Super Sed utility)</li><li>Identify references to Sections (Python)</li><li>Recursively apply steps #1-4 above to each file in nested folders to convert all California's Codes. (Linux Find utility)</li></ol></div><div style="clear: both;">To choose a tool for each step, my preference was for a ready-made script or program that does as much of the job as possible, while still providing the flexibility to tweak the output as needed. Details of each tool, how I installed and put them all together, in future posts.</div><div style="clear: both;"></div><br class="final-break" style="clear: both;" />