---
layout: post
title: 'How to: Convert Sections Into Hyperlink Targets'
date: '2011-05-23T12:58:00.000-07:00'
author: Ari Hershowitz
tags:
- XHTML
- Open Government
- technical post
- California Legislation
- text conversion
- legislation
modified_time: '2011-05-23T12:58:51.500-07:00'
blogger_id: tag:blogger.com,1999:blog-7029518648320057552.post-923880379441954297
blogger_orig_url: https://blog.linkedlegislation.com/2011/05/how-to-convert-sections-into-hyperlink.html
---

<p style="clear: both">How to find section headings in a text document and convert them to targets for hyperlinks? </p><p style="clear: both">If you have ever had this burning question, you'll want to read on. Or you can take <a href="https://blog.tabulaw.com/2011/05/losing-data-in-pdf-all-kings-sources.html" title="Post 1" target="_blank">my</a> <a href="https://blog.tabulaw.com/2011/05/california-law-recovering-meaning-and.html" target="_blank">word</a> for it that it would have been better for this information to be included in the documents when they were originally published.</p><p style="clear: both">This post describes <a href="https://blog.tabulaw.com/2011/05/california-laws-converting-plain-text.html#Outline" title="Identify section headings" target="_blank">Step 2 of 5</a> to convert California statutes to structured html: Identify section, subsection and subdivision headings. To do this, I am using an old (1970s) Linux program called "<em>sed</em>" (stream editor).</p><p style="clear: both">There are lots of ways to do this using more modern programming languages, but sed has the advantages that it is VERY fast, and it has built in the operations of opening, editing and closing a file. It's basically a "find and replace" function on steroids, without the need for <a href="https://m.npr.org/news/front/18121696?singlePage=false" title="NPR report on baseball steroids hearings" target="_blank">Congressional hearings</a>.I must admit, that once I got the hang of sed, and its improved cousin, "<a href="https://sed.sourceforge.net/grabbag/ssed/" title="Super Sed" target="_blank">Super Sed</a>", it was pretty addictive: with one command, you can change all capital letters in a document to lower case, or replace all vowels with a *, or mark all numbers and letters at the beginning of a paragraph as section and subsection headings. <em>Sed</em> goes through a file one line at a time and makes these substitutions. <em>Sed</em> is quite powerful and there are actually a number of other things you can do with <em>sed</em>, operating one line at a time through a text. If this sounds like fun to you, look <a href="https://www.grymoire.com/Unix/Sed.html" title="Sed tutorial" target="_blank">here</a> for a good tutorial.</p><p style="clear: both">I was working with California state statutes, which I had earlier <a href="https://blog.tabulaw.com/2011/05/how-to-convert-text-to-html-using.html" title="Text to HTML how-to" target="_blank">converted to html</a>. Fortunately, the statute text has a very regular structure: sections, subdivisions and other levels of the document were marked at the beginning of lines, with consistent spacing setting them apart.</p><p style="clear: both">So to find the section headings, I just needed to create a set of rules (using <a href="https://en.wikipedia.org/wiki/Regular_expression" title="Wikipedia article on RegEx" target="_blank">RegEx</a>), that describe each kind of section heading. California statutes use headings with the following levels:</p><p style="clear: both">100<br />100.1<br />100.1 (a)<br />100.1 (a) (1)</p><p style="clear: both">So I needed to describe each of these section headings in a way that they could be identified and separated from any other numbers and letters that are found within the statutes. Here's an example of a rule that does this:</p><blockquote style="clear: both"><p style="clear: both">s_^&lt;p&gt;([1-9]\d*)\._&lt;p&gt;&lt;span class="section level1" id="sec-\1\."&gt;\1\.&lt;\/span&gt;_</p></blockquote><p style="clear: both">It looks gory, but is actually pretty tame. In essence, it says to substitute (s_) any number at the beginning of a line (^) and beginning of a paragraph (&lt;p&gt;) with a label (&lt;span&gt;) that will identify this number as a section heading. Each kind of heading requires another rule to describe it, and then all of these rules are applied to the file using the <em>ssed</em> (Super Sed) command. The result converts a section heading like this:</p><blockquote style="clear: both"><p style="clear: both">&lt;p&gt;15210. Notwithstanding any other provision of this code, as used in</p></blockquote><p style="clear: both">to something like this:</p><blockquote style="clear: both"><p style="clear: both">&lt;p&gt;&lt;span class="section level1" id="sec15210."&gt;15210.&lt;/span&gt; Notwithstanding any other provision of this code, as used in</p></blockquote><p style="clear: both">Not rocket science, but one step closer to structured data. The &lt;span&gt; will allow us to separate out this section from the rest of the text in order, for example, to link to this section from another section that references it.</p><p style="clear: both">The next step is to find all of the references to other sections that are found <strong>inside</strong> the statute text and to place links <strong>from</strong> those references <strong>to</strong> the sections they refer to. Unfortunately, those references may cross over more than one line, it is harder to use a line-by-line editor such as <em>sed </em>to do the job. For this, I put together a short search and replace program in the Python programming language, which is more flexible and has a lot of tools to for working with text. That will be step 3 in the 5 step process, for a future post. </p><p style="clear: both">As I mentioned earlier, I will be publishing the final scripts on Github, and will be publishing the hyperlinked version of California legislative information. And hopefully this can inspire California's legislature to publish the statutes in a structured data format to begin with, which can be combined with the OpenStates data to make it easier to see the changes that would be made by any proposed legislation.</p><br class='final-break' style='clear: both' />