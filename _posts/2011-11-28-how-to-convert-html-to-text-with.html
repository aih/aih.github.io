---
layout: post
title: How to Convert HTML to Text, With Formatting
date: '2011-11-28T23:29:00.001-08:00'
author: Ari Hershowitz
tags:
- htmltotext
- HTML
- Perl
- Lynx
- w3m
- California Legislation
- text
- texttohtml
- California
- legislation
modified_time: '2011-11-29T23:19:52.798-08:00'
blogger_id: tag:blogger.com,1999:blog-7029518648320057552.post-4380768918123896596
blogger_orig_url: https://blog.linkedlegislation.com/2011/11/how-to-convert-html-to-text-with.html
---

My current best answer: this <a href="https://www.mbayer.de/html2text/files.shtml">html2text package</a>&nbsp;from Germany. &nbsp;It can be installed easily on a MacOS with Macports (<i>$ sudo port install html2text</i>), and on other Unix-like systems through their package managers. &nbsp;It has a number of useful options, and I use it like this:<br /><br /><blockquote class="tr_bq"><i>html2text -nobs -ascii -width 200 -style pretty -o filename.txt - &lt; filename.html</i></blockquote><br />So now that you know my current answer, here's the problem: not all html is created equal. &nbsp;Legislative data is published in a variety of formats, some uglier than others. &nbsp;Extracting information requires cleaning these formats up.<br /><br />When I started to work with California legislation, I had the problem of converting the state's plain text into a simple html for use on web pages. &nbsp;To do that, <a href="https://blog.tabulaw.com/2011/05/how-to-convert-text-to-html-using.html">I used a Perl text2html module</a>. &nbsp;While <a href="https://blog.tabulaw.com/2011/05/california-laws-converting-plain-text.html">it takes many steps</a> to produce web-friendly html from California's laws, at least the plain text was not cluttered with formatting symbols and tags that could interfere with the core text.<br /><br />The problems in other states is far worse. &nbsp;Some versions of Iowa's bills, for example, appear to be published directly from Microsoft Word to the web, which means that they're littered with a maze of formatting information--sometimes positioning each word on the page--that is not related to the text of the bill. &nbsp;Other states use hundreds of cells of an html table (or multiple tables) to format the bill. &nbsp;Looking at the file on the state's website, you wouldn't know that the underlying data is so messy.<br /><br />Simply stripping all of the html tags won't work, because that eliminates all the formatting information, including information that can change the bill's meaning (spaces, paragraphs). That's unfortunate, because there are many html libraries that would make stripping out the tags easy (e.g. <a href="https://www.crummy.com/software/BeautifulSoup/">Beautiful Soup</a> for python, or <a href="https://www.crummy.com/software/RubyfulSoup/">similar</a> <a href="https://htmlparser.sourceforge.net/">libraries</a> <a href="https://nokogiri.org/">in</a> <a href="https://search.cpan.org/~gaas/HTML-Parser-3.69/Parser.pm">other</a> <a href="https://ejohn.org/blog/pure-javascript-html-parser/">languages</a>). &nbsp;What I want to do is preserve the formatting, but do it with spaces and paragraphs, not tables or graphically positioning words.<br /><br />Ironically, the most effective way to clean this messy data is also the easiest: copy and paste the bill displayed on your web browser. &nbsp;After all, the formatting was made for the browser to interpret, and the copy-paste function (at least on a Mac) is quite faithful to the formatting. &nbsp;However, automating this copy and paste process is far from simple and, with one exception, I have not seen any programs that make use of this native browser capability to convert files in bulk. &nbsp;The exception is the <a href="https://stackoverflow.com/questions/901697/html-to-text-conversion-in-shell-script">use of the Linux web browser, Lynx</a>, which has a function "Lynx -dump". &nbsp;However, this converter &nbsp;apparently has a number of faults, including an inability to process tables. &nbsp;<b>Anyone know how to use Chrome or Firefox to automate conversion of html to text for large numbers of files?</b>&nbsp;This is still the solution I'd prefer.<br /><br />But barring that, I found a close second, in the form of the html2text program. &nbsp;Although it's relatively old (2004), it's fast and deals reasonably with tables and other formatting such as underlining and strikeouts.<br /><br /><b>Edit: </b>Upon the suggestion by Frank Bennett, below, I installed the <a href="https://w3m.sourceforge.net/" target="_blank">w3m text browser</a>&nbsp;and used it to produce formatted text from html using the following command-line syntax:<br /><blockquote class="tr_bq"><i>w3m filename.html -dump &gt; file.txt</i></blockquote>Like html2text, it is fast and produces clean output, actually somewhat too clean. &nbsp;The saved file strips some important formatting information, like &lt;u&gt; (underline) tags, so some caution is in order when using this method.